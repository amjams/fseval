---
sidebar_position: 1
---

# DatasetConfig

<!-- Docusaurus -->
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

<!-- fseval -->
import DatasetConfig from '!!raw-loader!../../../fseval/config/dataset.py';
import OpenMLDataset from '!!raw-loader!../../../fseval/config/adapters/openml_dataset.py';
import WandbDataset from '!!raw-loader!../../../fseval/config/adapters/wandb_dataset.py';

<!-- fseval YAML configs -->
import IrisDatasetYAML from '!!raw-loader!../../../tests/integration/conf/dataset/iris.yaml';
import ChenSwitchDatasetYAML from '!!raw-loader!../../../tests/integration/conf/dataset/chen_switch.yaml';

Datasets can be loaded with well-defined dataset configs. The dataset config looks as follows:

<CodeBlock className="language-python">{DatasetConfig}</CodeBlock>

## Available adapters
Built-in, the following adapters are available.

### OpenML
To load datasets from [OpenML](https://www.openml.org/), use the `fseval.adapters.openml.OpenML` adapter.

<CodeBlock className="language-python">{OpenMLDataset}</CodeBlock>

So, for example, loading the [Iris](https://www.openml.org/d/61) dataset:

<Tabs groupId="config-representation">
<TabItem value="yaml" label="YAML" default>

<CodeBlock className="language-yaml" title="conf/dataset/iris.yaml">{IrisDatasetYAML}</CodeBlock>


</TabItem>
<TabItem value="structured" label="Structured Config">

Any dataset can also be configured using Python code. Like so:

```python
from hydra.core.config_store import ConfigStore
from fseval.config import DatasetConfig
from fseval.config.adapters import OpenMLDataset
from fseval.types import Task

cs = ConfigStore.instance()

cs.store(
    group="dataset",
    name="iris",
    node=DatasetConfig(
        name="Iris Flowers",
        task=Task.classification,
        adapter=OpenMLDataset(dataset_id=61, target_column="class"),
    ),
)
```

</TabItem>
</Tabs>

### Weights and Biases
To load a dataset from [Weights and Biases](https://wandb.ai/) [artifacts](https://docs.wandb.ai/guides/artifacts), use the `fseval.adapters.wandb.Wandb` adapter.

<CodeBlock className="language-python">{WandbDataset}</CodeBlock>

So, for example, loading a dataset from wandb:

<CodeBlock className="language-yaml" title="conf/dataset/chen.yaml">{ChenSwitchDatasetYAML}</CodeBlock>

> Note: `feature_importances` indicates the ground truth relevant features in the dataset.


## ⚙️ Custom Adapters
To load datasets from different sources, we can use different **adapters**. You can create an adapter by implementing this interface:

```python
class AbstractAdapter(ABC, BaseEstimator):
    @abstractmethod
    def get_data(self) -> Tuple[List, List]:
        ...
```

For example:

```python title="benchmark.py"
@dataclass
class CustomAdapter(AbstractAdapter):
    def get_data(self) -> Tuple[List, List]:
        X = [[]]
        Y = []

        return X, Y
```

## Example configs

We can also use _functions_ as adapters, as long as they return a tuple `(X, y)`. e.g. using `sklearn.datasets.make_classification` as an adapter:

<Tabs groupId="config-representation">
<TabItem value="yaml" label="YAML" default>

```yaml title="conf/dataset/synthetic_dataset.yaml"
name: My synthetic dataset
task: classification
adapter:
  _target_: sklearn.datasets.make_classification
  n_samples: 10000
  n_informative: 2
  n_classes: 2
  n_features: 20
  n_redundant: 0
  random_state: 0
  shuffle: false
feature_importances:
  X[:, 0:2]: 1.0
```

</TabItem>
<TabItem value="structured" label="Structured Config">

```python
from hydra.core.config_store import ConfigStore
from fseval.config import DatasetConfig
from fseval.types import Task

cs = ConfigStore.instance()

cs.store(
    group="dataset",
    name="synthetic_dataset",
    node=DatasetConfig(
        name="My synthetic dataset",
        task=Task.classification,
        adapter=dict(
            _target_="sklearn.datasets.make_classification",
            n_samples=10000,
            n_informative=2,
            n_classes=2,
            n_features=20,
            n_redundant=0,
            random_state=0,
            shuffle=False,
        ),
        feature_importances={
            "X[:, 0:2]": 1.0
        }
    ),
)
```

</TabItem>
</Tabs>

For more examples, see the repo for more [dataset configs](https://github.com/dunnkers/fseval/tree/master/tests/integration/conf/dataset).
